package crai_test

import (
	"fmt"
	"strings"
	"testing"

	"github.com/brentp/goleft/indexcov/crai"
)

func TestCrai(t *testing.T) {

	s := strings.NewReader(`0	1	2	3	4	5
0	10	20	30	40	50
`)
	cr, err := crai.ReadIndex(s)
	if err != nil {
		t.Fatal(err)
	}

	if len(cr.Slices) != 1 {
		t.Fatalf("expected 1 chromosome, got %d", len(cr.Slices))
	}

	sl := cr.Slices[0]

	if len(sl) != 2 {
		t.Fatalf("expected 2 slices, got %d", len(sl))
	}

	for _, t := range sl {
		_, _, _ = t.Start(), t.Span(), t.SliceBytes()
	}

}

// 1146880
var idx = `0	10000	98379	36840	1620	376975
0	108293	223811	415455	1235	340259
0	332008	216930	756971	1581	339687
0	548839	19350	1098262	1169	352877
0	568089	106488	1452331	1368	345918
0	674487	90494	1799640	1409	365740
0	764899	125730	2166812	1712	350645
0	890534	140973	2519192	1486	364685
0	1031414	139590	2885386	1588	356302
0	1170919	140119	3243299	1572	359060
0	1310940	137115	3603954	1529	365674
0	1448024	133108	3971180	1835	363843
0	1581038	137289	4336881	1750	369761
0	1718228	136278	4708415	1548	335329
0	1854421	123464	5045315	1402	353039
0	1977820	127030	5399779	1608	350448
0	2104772	129146	5751858	1563	348622
0	2233827	127856	6102067	1455	349386
0	2361588	129725	6452932	1261	356680
0	2491213	101511	6810897	1501	365948
0	2592624	28814	7178370	1358	397107
0	2621348	150582	7576859	1476	369734
0	2771851	119185	7948093	1258	342981
0	2890957	124205	8292356	1243	341129
0	3015072	123311	8634752	1439	348721
0	3138297	118843	8984936	1593	344954
0	3257052	127723	9331507	1347	344047
0	3384716	119494	9676925	1294	357167
0	3504120	128298	10035410	1414	346775
0	3632331	126302	10383623	1525	342429
0	3758552	274674	10727601	1614	337424
0	4033134	117718	11066663	1594	337403
0	4150756	120352	11405684	1606	333740
0	4271012	125762	11741054	1743	323584
0	4396681	118868	12066405	1311	323366
0	4515486	123210	12391106	1265	319824
0	4638603	120369	12712219	1520	332580
0	4758884	123362	13046343	1433	328811
0	4882163	119054	13376611	1619	319867
0	5001119	124311	13698121	1696	315595
0	5125364	128076	14015436	1624	315283
0	5253347	120690	14332367	1436	319389
0	5373958	116817	14653216	1610	318628
0	5490695	120899	14973478	1332	320077
0	5611504	120480	15294911	1850	322617
0	5731904	119029	15619402	1595	330318
0	5850846	113350	15951339	1597	340137
0	5964111	122145	16293097	1385	333181
0	6086160	126699	16627687	1344	341799
0	6212770	133028	16970854	1577	343277
0	6345707	130302	17315732	1532	342423
0	6475915	134951	17659711	1586	347598
0	6610772	131820	18008919	1592	340399
0	6742493	142259	18350934	1669	326444
0	6884663	124995	18679071	1483	320083
0	7009578	128186	19000661	1287	327744
0	7137666	120030	19329716	1589	323926
0	7257601	126671	19655255	1703	319685
0	7384175	121696	19976667	1976	332125
0	7505779	120973	20310792	1356	336230
0	7626682	115847	20648402	1672	338414
0	7742438	131032	20988512	1412	317677
0	7873372	131251	21307625	1551	320147
0	8004547	134702	21629347	1572	324015
0	8139149	135476	21954958	1618	329084
0	8274525	136750	22285684	1700	340582
0	8411190	127765	22627990	1549	321197
0	8538872	133492	22950760	1520	308348
0	8672266	127187	23260652	1437	309313
0	8799372	131584	23571426	1458	318471
0	8930860	128611	23891379	1660	332559
0	9059378	127131	24225622	1536	335656
0	9186411	130194	24562838	1472	337544
0	9316505	124536	24901878	1469	340396
0	9440952	127726	25243767	1500	337049
0	9568598	141719	25582340	1627	340949
0	9710221	133996	25924940	1664	336823
0	9844121	135187	26263451	1534	333708
0	9979217	140316	26598717	1633	334390
0	10119441	135019	26934764	1609	323217
0	10254373	134924	27259614	1455	316355
0	10389214	128926	27577448	1417	327449
0	10518042	136203	27906338	1614	323743
0	10654170	133162	28231719	1317	340278
0	10787233	132363	28573338	1497	337946
0	10919497	139654	28912805	1479	337748
0	11059065	132698	29252056	1792	335305
0	11191675	129656	29589177	1584	319516
0	11321276	129265	29910301	1562	336638
0	11450451	122715	30248525	1598	330873
0	11573071	120747	30581020	1444	333986
0	11693728	130360	30916474	1469	339153
0	11823991	123116	31257120	1430	337234
0	11947009	136104	31595808	1708	341470
0	12083015	134121	31939010	1567	337773
0	12217046	125235	32278374	1442	328336
0	12342184	125910	32608176	1501	309340
0	12468023	128067	32919041	1381	318171
0	12596001	129826	33238617	1536	332458
0	12725728	120211	33572635	1540	318404
0	12845852	180913	33892603	1822	385639
0	13026751	193054	34280088	1521	373550
0	13219744	278442	34655183	1606	390541
0	13498096	261376	35047354	1499	383871
0	13759375	139139	35432748	1596	336999
0	13898433	132644	35771367	1675	324553
0	14030993	127855	36097619	1624	318606
0	14158764	125722	36417873	1559	313294
0	14284393	120888	36732750	1573	311154
0	14405198	122270	37045501	1461	313614
0	14527375	120685	37360600	1625	307387
0	14647972	120448	37669636	1846	314702
0	14768327	126877	37986208	1554	315066
0	14895110	124435	38302852	1357	320150
0	15019451	120243	38624383	1780	326472
0	15139606	121377	38952659	1430	327047
0	15260885	125905	39281160	1396	334528
0	15386691	127795	39617108	1551	330634
0	15514402	124196	39949317	1576	326422
0	15638501	131727	40277339	1684	329656
0	15770128	134594	40608703	1538	329025
0	15904632	132167	40939290	1471	326325
0	16036721	143719	41267110	1636	341469
0	16180343	134667	41610239	1521	323024
0	16314912	128708	41934808	1612	346945
0	16443521	130188	42283389	1421	341259
0	16573611	140706	42626093	1488	326262
0	16714238	122851	42953867	1623	342607
0	16836990	56350	43298121	1682	364620
0	16893240	38344	43664447	1620	351089
0	16931488	34562	44017180	1581	350140
0	16965951	56950	44368925	1743	382390
0	17022806	51941	44753082	1919	371560
0	17074648	102243	45126585	1498	367099
0	17176793	84066	45495206	2072	365636
0	17260784	123192	45862938	1738	343847
0	17383896	124299	46208547	1590	331221
0	17508096	125537	46541382	1472	333015
0	17633554	128725	46875893	1699	338509
0	17762197	138249	47216125	1575	338019
0	17900383	118002	47555743	1302	335947
0	18018301	124842	47893016	1606	329257
0	18143047	117392	48223903	1510	323080
0	18260345	118877	48548517	1568	327320
0	18379136	119512	48877429	1564	328883
0	18498549	116652	49207900	1366	324878
0	18615104	114931	49534168	1744	327737
0	18729942	121752	49863673	1632	319702
0	18851622	129914	50185031	1515	329613
0	18981440	122962	50516183	1522	328620
0	19104309	116009	50846349	1458	335808
0	19220322	122864	51183639	1569	334383
0	19343131	128481	51519615	1414	323724
0	19471522	125783	51844777	1425	321161
0	19597217	123320	52167387	1716	335798
0	19720437	123959	52504925	1717	327931
0	19844298	135030	52834597	1648	326199
0	19979229	125831	53162468	1411	329689
0	20104964	130883	53493592	1452	318283
0	20235761	121191	53813351	1664	318562
0	20356869	120008	54133601	1181	320739
0	20476786	125569	54455545	1618	324297
0	20602272	119638	54781484	1459	326087
0	20721827	126216	55109054	1438	325701
0	20847968	132328	55436217	1596	328716
0	20980217	129820	55766553	1628	330752
0	21109952	135858	56098957	1834	312722
0	21245716	133008	56413537	1645	305135
0	21378670	145007	56720341	1763	317179
0	21523577	124960	57039307	1528	334865
0	21648448	132127	57375724	1912	338920
0	21780503	126885	57716580	1768	336635
0	21907296	125927	58055007	1529	336941
0	22033162	134424	58393501	1620	329337
0	22167491	126422	58724482	1673	342363
0	22293815	136798	59068542	1823	339536
0	22430545	124881	59409925	1512	331601
0	22555331	122989	59743062	1476	331213
0	22678264	121469	60075775	1650	319197
0	22799637	119769	60396646	1440	325811
0	22919328	120880	60723921	1506	332451
0	23040151	121567	61057902	1476	331124
0	23161620	120925	61390526	1562	330808
0	23282458	129291	61722920	1596	314333
0	23411653	131186	62038873	1486	321528
0	23542750	140221	62361911	1688	320914
0	23682890	129770	62684537	1641	331197
0	23812621	130588	63017399	1740	334262
0	23943120	133457	63353425	1797	330272
0	24076482	136720	63685518	1899	335286
0	24213115	192739	64022727	2040	354522
0	24405758	123908	64379313	1721	329944
0	24529601	125022	64711002	1573	325582
0	24654523	120479	65038181	1666	319348
0	24774909	130974	65359219	1657	323252
0	24905787	135988	65684152	1668	327689
0	25041692	141106	66013533	1725	321809
0	25182720	127162	66337091	1386	333489
0	25309797	120930	66671990	1563	334787
0	25430629	128512	67008364	1443	324474
0	25559057	160119	67334305	1577	343559
0	25719093	135729	67679465	1755	328266
0	25854722	124097	68009510	1671	328928
0	25978720	121334	68340133	1404	328949
0	26099977	130567	68670510	1515	329509
0	26230444	133509	69001558	1658	328378
0	26363882	129282	69331618	1406	326186
0	26493092	128283	69659234	1654	334164
0	26621279	138438	69995076	1614	334586
0	26759621	132598	70331300	1787	331896
0	26892125	146296	70665007	1675	329879
0	27038346	129293	70996586	1653	324469
0	27167541	132715	71322733	1579	336984
0	27300161	136510	71661321	1710	339103
0	27436572	136693	72002159	1687	330886
0	27573197	131549	72334757	1597	333197
0	27704689	136884	72669576	1680	328312
0	27841519	131362	72999593	1326	335748
0	27972794	134343	73336692	1598	324882
0	28107066	131720	73663197	1817	325813
0	28238710	134120	73990852	1582	319574
0	28372742	135080	74312033	1700	324486
0	28507732	139078	74638244	1628	327348
0	28646718	144368	74967245	1691	324350
0	28791016	137939	75293311	1823	336174
0	28928856	146271	75631333	1712	334391
0	29075031	135218	75967461	1691	334257
0	29210151	135366	76303434	1712	319432
0	29345438	139965	76624603	1665	322194
0	29485309	126013	76948487	1612	326971
0	29611243	121295	77277095	1718	329436
0	29732447	120006	77608274	1287	325290
0	29852372	267034	77934876	1415	319186
0	30119323	119739	78255502	1607	324883
0	30238996	121987	78582017	1296	317736
0	30360913	119885	78901074	1834	322350
0	30480711	117124	79225283	1341	323737
0	30597746	120130	79550386	1518	317433
0	30717779	115091	79869362	1821	320854
0	30832796	113939	80192062	1888	330304
0	30946640	115546	80524279	1717	321154
0	31062088	114026	80847175	1637	327413
0	31176014	124454	81176250	1487	334532
0	31300369	131880	81512294	1542	328789
0	31432151	139711	81842650	1694	317112
0	31571793	142229	82161481	1712	337789
0	31713941	127382	82501007	1480	313775
0	31841225	121305	82816287	1439	332122
0	31962458	124923	83149873	1899	325343
0	32087284	117885	83477140	1500	332143
0	32205099	126876	83810808	1524	330584
0	32331909	136582	84142941	1513	321438
0	32468396	138714	84465917	1495	325694
0	32607013	132716	84793131	1637	331617
0	32739639	134017	85126410	1520	330781
0	32873574	133910	85458736	1550	325835
0	33007399	142657	85786146	1654	328184
0	33149967	139464	86116009	1877	336849
0	33289356	133799	86454760	1526	322692
0	33423061	127943	86779003	1681	327163
0	33550912	125401	87107872	1555	322778
0	33676221	120756	87432230	1562	326910
0	33796895	123243	87760727	1471	315163
0	33920040	121373	88077386	1643	315512
0	34041321	119534	88394566	1592	318930
0	34160756	120746	88715113	1596	314354
0	34281417	119120	89031088	1852	317370
0	34400480	115983	89350335	1486	314365
0	34516364	126505	89666211	1807	321626
0	34642780	123199	89989669	1632	314277
0	34765886	122685	90305603	1448	307032
0	34888471	126042	90614108	1222	312203
0	35014416	116423	90927558	1814	319615
0	35130742	119579	91249012	1540	320160
0	35250226	125513	91570737	1475	324146
0	35375639	137626	91896383	1635	316182
0	35513168	138758	92214225	1757	323258
0	35651834	144760	92539265	1782	317104
0	35796517	133622	92858176	1578	309557
0	35930047	131941	93169336	1613	317478
0	36061909	133507	93488452	1622	319542
0	36195339	138569	93809641	1584	318809
0	36333811	132204	94130059	1539	310879
0	36465922	134776	94442502	1713	322438
0	36600619	139332	94766678	1790	334976
0	36739862	130390	95103469	1604	333380
0	36870152	123688	95438478	1546	327308
0	36993746	120312	95767357	1402	323588
0	37113962	118758	96092372	1790	322894
0	37232629	115532	96417081	1486	325223
0	37348074	114509	96743815	1327	324362
0	37462486	119554	97069529	1576	324770
0	37581950	121046	97395900	1583	312353
0	37702902	120270	97709861	1481	322979
0	37823107	120198	98034346	1732	328431
0	37943273	131031	98364534	1544	323513
0	38074210	125065	98689616	1512	331801
0	38199177	128812	99022954	1759	323722
0	38327893	136269	99348460	1856	330928
0	38464073	122339	99681269	1422	327140
0	38586340	117616	100009856	1557	318528
0	38703858	118939	100329966	1692	317914
0	38822697	124818	100649597	1725	307848
0	38947422	119115	100959195	1530	314881
0	39066441	118801	101275631	1847	315414
0	39185191	123350	101592917	1678	318581
0	39308468	145335	101913201	1722	326176
0	39453755	141636	102241124	1708	330601
0	39595307	131131	102573458	1689	319376
0	39726340	129945	102894548	1575	310043
0	39856187	131434	103206191	1561	326202
0	39987537	124742	103533979	1527	329462
0	40112184	124785	103864993	1500	327628
0	40236893	131268	104194146	1647	327592
0	40368095	129783	104523410	1699	332305
0	40497792	127470	104857439	1496	314316
0	40625162	140137	105173276	1670	310789
0	40765200	134129	105485760	1777	321317
0	40899285	134452	105808879	1733	316432
0	41033727	129763	106127069	1505	323684
0	41163410	131448	106452283	1518	322403
0	41294787	128202	106776229	1541	329733
0	41422891	123059	107107528	1434	318222
0	41545854	126918	107427209	1734	303585
0	41672686	121581	107732553	1588	315207
0	41794167	119646	108049373	1429	328997
0	41913722	114843	108379824	1879	337368
0	42028498	118881	108719096	1367	322650
0	42147294	117613	109043138	1266	320138
0	42264809	121504	109364567	1430	315918
0	42386221	122539	109681940	1597	307316
0	42508667	123667	109990878	1557	312464
0	42632237	129446	110304924	1651	305187
0	42761593	125857	110611787	1471	310111
0	42887351	128938	110923394	1580	307475
0	43016191	128854	111232474	1495	307032
0	43144955	128227	111541026	1645	324883
0	43273089	126209	111867579	1595	315776
0	43399222	126509	112184975	1491	329169
0	43525654	123452	112515660	1690	319435
0	43649009	127026	112836810	1554	324111
0	43775941	123222	113162500	1514	324964
0	43899066	123347	113489003	1492	325546
0	44022317	120920	113816066	1614	335805
0	44143146	129143	114153510	1467	315443
0	44272191	126251	114470445	1430	318993
0	44398352	122452	114790893	1461	334255
0	44520714	134315	115126634	1716	320137
0	44654931	117333	115448512	1356	321405
0	44772216	126013	115771298	1488	316813
0	44898142	126559	116089624	1512	317851
0	45024607	123081	116409012	1481	330486
0	45147611	131902	116741004	1676	336646
0	45279424	137211	117079351	1699	325244
0	45416548	127133	117406319	1825	320644
0	45543588	132205	117728813	1757	314165
0	45675698	127238	118044760	1716	320841
0	45802864	132259	118367342	1551	314921
0	45935033	133255	118683839	1704	331730
0	46068225	135392	119017298	1818	321543
0	46203527	129232	119340684	1830	317193
0	46332702	133329	119659732	1697	311482
0	46465964	124198	119972936	1660	313287
0	46590062	132407	120287908	1670	325246
0	46722382	131259	120614849	1647	328099
0	46853549	122416	120944620	1555	335177
0	46975877	120353	121281377	1539	328858
0	47096131	123213	121611799	1606	311154
0	47219264	120154	121924584	1735	321420
0	47339321	118248	122247764	1453	319897
0	47457472	121747	122569139	1671	319200
0	47579122	119825	122890035	1626	325355
0	47698903	141878	123217041	1642	319302
0	47840698	128598	123538010	1431	322663
0	47969221	117333	123862129	1514	317390
0	48086461	123159	124181058	1336	321733
0	48209553	115114	124504152	1222	322598
0	48324570	115265	124827997	1559	318118
0	48439739	125666	125147699	1601	315648
0	48565315	124971	125464973	1709	312492
0	48690204	123761	125779199	1628	308597
0	48813874	133697	126089449	1678	304571
0	48947484	128484	126395723	1464	309197
0	49075885	119831	126706409	1401	309058
0	49195617	124153	127016893	1419	304941
0	49319677	123304	127323278	1337	298190
0	49442882	126664	127622830	1488	300259
0	49569453	124889	127924602	1779	296048
0	49694243	131501	128222454	1669	302705
0	49825650	129726	128526853	1546	293007
0	49955280	129228	128821431	1520	300060
0	50084417	128872	129123036	1723	295745
0	50213192	126632	129420529	1470	296291
0	50339753	127659	129718315	1705	303266
0	50467370	126804	130023311	1465	298845
0	50594077	123634	130323646	1538	303181
0	50717638	117805	130628390	1780	315204
0	50835347	135041	130945399	1505	310136
0	50970298	136057	131257065	1417	299038
0	51106262	139430	131557545	1728	309504
0	51245598	128617	131868802	1659	300059
0	51374116	132569	132170545	1683	307850
0	51506593	130531	132480103	1334	302513
0	51637047	134408	132783975	1542	317909
0	51771363	126740	133103451	1612	315780
0	51898012	136872	133420868	1555	307371
0	52034788	130611	133729819	1362	308990
0	52165311	132328	134040196	1565	302724
0	52297592	129083	134344510	1492	313924
0	52426579	135544	134659951	1629	317965
0	52562026	134084	134979570	1814	317048
0	52696013	130088	135298457	1616	310568
0	52826014	129879	135610666	1472	310563
0	52955823	140305	135922726	1433	314959
0	53096030	136340	136239143	1708	326495
0	53232272	146888	136567371	1677	319125
0	53379073	135430	136888198	1634	312421
0	53514404	116767	137202278	1354	331261
0	53631082	123934	137534918	1426	319617
0	53754924	121635	137855986	1272	329799
0	53876463	124721	138187082	1483	331984
0	54001092	110698	138520574	1592	326605
0	54111696	122451	138848796	1337	323864
0	54234081	129588	139174022	1474	312016
0	54363572	130031	139487537	1598	319609
0	54493506	128683	139808769	1507	317137
0	54622089	119061	140127438	1673	333567
0	54741059	126673	140462703	1696	329257
0	54867672	142939	140793681	1748	334295
0	55010524	130554	141129749	1769	331751
0	55140980	121636	141463294	1325	324191
0	55262523	121908	141788835	1861	327547
0	55384335	124300	142118268	1685	329892
0	55508551	127430	142449870	1467	306592
0	55635888	132779	142757954	1535	309825
0	55768579	123394	143069339	1265	308906
0	55891876	122948	143379535	1530	309402
0	56014738	124127	143690492	1611	307921
0	56138775	125672	144000049	1371	301868
0	56264348	125948	144303313	1337	297367
0	56390257	127401	144602042	1536	300031
0	56517563	125676	144903634	1480	298945
0	56643144	120932	145204084	1835	302254
0	56763977	133127	145508198	1629	309790
0	56897080	126544	145819642	1480	311797
0	57023533	139145	146132944	1625	307302
0	57162581	127939	146441896	1324	299757
0	57290431	124018	146743002	1271	306194
0	57414364	125008	147050492	1288	306738
0	57539303	126514	147358543	1254	303533
0	57665731	123927	147663355	1554	304303
0	57789589	125536	147969237	1390	302506
0	57915033	126314	148273158	1654	305888
0	58041252	126997	148580725	1661	304769
0	58168156	128368	148887180	1278	299950
0	58296428	121731	149188433	1754	303508
0	58418065	121751	149493720	1377	307580
0	58539788	121926	149802702	1594	309342
0	58661615	119749	150113663	1724	308774
0	58781270	117053	150424186	1933	307554
0	58898226	125351	150733698	1641	307306
0	59023486	124310	151042670	1686	310063
0	59147706	128596	151354444	1633	310022
0	59276203	122372	151666124	1602	309479
0	59398506	116214	151977230	1777	312509
0	59514634	123342	152291541	1411	305484
0	59637878	123171	152598461	1812	304681
0	59760962	124464	152904979	1444	306152
0	59885345	123541	153212600	1594	306611
0	60008796	121503	153520830	1672	310391
0	60130212	121698	153832918	1397	306512
0	60251835	133907	154140852	1338	296080
0	60385663	124573	154438295	1439	300306
0	60510137	130885	154740065	1311	297135
0	60640942	128328	155038536	1603	297269
0	60769175	131412	155337433	1667	298255
0	60900489	132811	155637380	1750	301724
0	61033213	128198	155940879	1683	300801
0	61161332	125738	156243388	1552	302278
0	61286981	129901	156547243	1322	305064
0	61416794	133559	156853654	1459	312542
0	61550259	133423	157167680	1442	301658
0	61683583	132581	157470805	1456	301582
0	61816090	131900	157773868	1413	305533
0	61947920	125930	158080839	1558	306376
0	62073754	138799	158388798	1605	314458
0	62212461	143171	158704886	1837	309862
0	62355533	139633	159016610	1726	312892
0	62495089	133251	159331253	1615	315143
0	62628264	131669	159648036	1754	328117
0	62759839	135204	159977932	1458	322114
0	62894943	140244	160301529	1545	299278
0	63035097	139443	160602377	1700	304587
0	63174474	135499	160908689	1616	306056
0	63309895	131975	161216386	1355	300706
0	63441824	126758	161518472	1597	308934
0	63568483	134971	161829028	1393	299920
0	63703370	140785	162130366	1681	314938
0	63844078	141654	162447010	1636	301712
0	63985635	132869	162750383	1439	303220
0	64118418	126381	163055067	1588	318104
0	64244701	128347	163374784	1457	306236
0	64372952	124030	163682502	1604	307339
0	64496891	126344	163991470	1563	304930
0	64623163	132678	164297988	1683	308897
0	64755752	131945	164608593	1758	311983
0	64887639	131132	164922359	1443	303764
0	65018695	128120	165227591	1456	303213
0	65146742	131254	165532285	1633	301615
0	65277950	128602	165835558	1474	309285
0	65406452	134972	166146342	1525	314707
0	65541327	127872	166462599	1619	318798
0	65669110	128379	166783041	1653	307944
0	65797409	125620	167092663	1617	304726
0	65922935	126263	167399031	1710	306398
0	66049103	131102	167707164	1784	302608
0	66180121	128710	168011581	1452	297695
0	66308753	128032	168310753	1641	297927
0	66436692	128327	168610346	1595	293935
0	66564937	125772	168905901	1685	302973
0	66690638	119220	169210584	1368	297912
0	66809763	125241	169509889	1460	299226
0	66934905	123247	169810600	1656	302147
0	67058054	124123	170114428	1568	299593
0	67182078	133728	170415614	1672	301615
0	67315730	134957	170718926	1491	296738
0	67450590	123536	171017180	1527	305786
0	67574039	128812	171324518	1547	309714
0	67702796	125396	171635804	1615	308456
0	67828126	130174	171945900	1603	311876
0	67958239	127521	172259404	1607	316644
0	68085661	121955	172577680	1658	306279
0	68207548	123825	172885642	1654	304756
0	68331290	126951	173192077	1602	302445
0	68458143	128817	173496149	1745	303223
0	68586864	128377	173801142	1408	309368
0	68715173	134970	174111943	1501	307231
0	68850062	134001	174420700	1538	301367
0	68983985	134400	174723630	1413	291019
0	69118289	130892	175016087	1797	299725
0	69249082	128139	175317634	1691	303600
0	69377140	130556	175622950	1743	300411
0	69507599	131794	175925129	1690	301343
0	69639302	133683	176228187	1532	293668
0	69772890	130581	176523412	1521	297505
0	69903385	138624	176822463	1777	297041
0	70041915	135629	177121306	1677	291309
0	70177446	134879	177414317	1350	289125
0	70312239	137774	177704817	1791	304759
0	70449924	137229	178011392	1534	290127
0	70587056	138979	178303078	1429	297745
0	70725952	146140	178602277	1657	312463
0	70871996	134360	178916422	1615	304550
0	71006270	131031	179222612	1734	301660
0	71137203	133020	179526031	1612	298706
0	71270128	130048	179826374	1560	298847
0	71400103	132164	180126806	1365	298008
0	71532170	130706	180426204	1635	299817
0	71662780	133126	180727681	1688	296610
0	71795806	136098	181026004	1258	293276
0	71931812	136388	181320563	1627	296244
0	72068138	136959	181618459	1378	290800
0	72205009	134705	181910662	1531	291367
0	72339615	146039	182203585	1602	293919
0	72485566	147997	182499131	1388	287289
0	72633483	156163	182787833	1327	288209
0	72789626	155130	183077394	1646	293822
0	72944682	136784	183372887	1430	290081
0	73081378	143420	183664423	1363	288813
0	73224703	136016	183954624	1547	291428
0	73360620	141755	184247624	1687	298631
0	73502288	139941	184547967	1378	295928
0	73642150	145716	184845298	1652	294727
0	73787770	140915	185141702	1677	293954
0	73928593	140617	185437358	1589	291654
0	74069149	135660	185730626	1426	291319
0	74204713	138785	186023396	1587	290504
0	74343403	137859	186315512	1178	292910
0	74481168	139952	186609625	1801	294247
0	74621023	139895	186905698	1459	291406
0	74760854	138373	187198588	1610	297189
0	74899160	130103	187497412	1674	302684
0	75029178	129948	187801795	1187	292687
0	75159034	134881	188095694	1517	298032
0	75293820	126224	188395268	1656	300501
0	75419948	131906	188697450	1700	296054
0	75551760	135071	188995229	1631	303569
0	75686747	137209	189300454	1484	294977
0	75823861	128399	189596940	1835	303550
0	75952177	138064	189902350	1455	296637
0	76090142	132129	190200467	1835	310499
0	76222241	140935	190512826	1736	307934
0	76363079	134660	190822521	1573	297147
0	76497701	130105	191121266	1572	309588
0	76627722	128624	191432451	1543	303070
0	76756246	128608	191737089	1265	296584
0	76884777	131476	192034963	1604	297078
0	77016168	129829	192333670	1486	296517
0	77145911	127064	192631698	1650	300171
0	77272890	125316	192933544	1755	302873
0	77398108	122238	193238197	1655	306680
0	77520250	133626	193546557	1721	297063
0	77653777	128879	193845366	1439	297549
0	77782572	136162	194144379	1597	300748
0	77918636	129217	194446749	1526	310826
0	78047757	134351	194759126	1522	302041
0	78182016	142988	195062714	1603	311938
0	78324920	145689	195376280	1766	310796
0	78470514	137033	195688867	1601	305338
0	78607482	122650	195995831	1728	304879
0	78730063	125347	196302463	1632	298534
0	78855354	128745	196602654	1587	299487
0	78984000	131243	196903753	1496	292995
0	79115143	133386	197198269	1192	294217
0	79248439	133246	197493703	1638	297824
0	79381592	138910	197793190	1535	293988
0	79520404	134590	198088738	1586	292466
0	79654894	134581	198382815	1466	292002
0	79789382	133847	198676308	1307	292698
0	79923135	136521	198970338	1701	300137
0	80059566	140064	199272201	1646	298324
0	80199551	137480	199572196	1433	291416
0	80336949	137026	199865070	1745	302526
0	80473898	139716	200169366	1633	297670
0	80613517	138638	200468694	1223	291396
0	80752062	142305	200761338	1696	294856
0	80894272	145373	201057915	1563	291290
0	81039547	137863	201350793	1564	290806
0	81177349	137381	201643188	1540	292874
0	81314639	139671	201937627	1643	297619
0	81454248	139288	202236914	1372	290909
0	81593449	135273	202529220	1524	298712
0	81728631	133477	202829481	1480	297068
0	81862035	134427	203128054	1407	302820
0	81996369	137280	203432306	1460	301035
0	82133590	142799	203734826	1517	302650
0	82276317	145445	204039018	1460	291346
0	82421679	134928	204331849	1556	302643
0	82556516	129881	204636073	1439	301125
0	82686339	141020	204938662	1696	302884
0	82827266	133248	205243267	1417	292730
0	82960427	136423	205537439	1605	296093
0	83096751	142571	205835162	1567	292738
0	83239256	133090	206129492	1272	295273
0	83372246	134800	206426062	1391	298887
0	83506952	131659	206726365	1606	305224
0	83638537	135448	207033220	1736	329515
0	83773920	125004	207364496	1696	327886
0	83898830	130808	207694103	1312	307819
0	84029544	130146	208003259	1616	302596
0	84159595	128812	208307496	1437	299465
0	84288313	132162	208608423	1559	294668
0	84420377	133807	208904675	1586	295580
0	84554095	135154	209201866	1211	285636
0	84689186	125597	209488738	1744	303135
0	84814685	126423	209793642	1724	304643
0	84941038	139165	210100034	1480	298987
0	85080105	132703	210400526	1321	301362
0	85212784	123701	210703234	1322	309700
0	85336401	128071	211014281	1512	307206
0	85464381	135409	211323024	1661	304265
0	85599698	137364	211628975	1671	305172
0	85736965	127036	211935843	1450	303602
0	85863924	121472	212240920	1710	305264
0	85985300	108570	212547919	1594	308784
0	86093771	135793	212858322	1765	303879
0	86229466	138736	213163991	1733	301971
0	86368143	136808	213467720	1757	297254
0	86504862	134452	213766756	1776	301449
0	86639223	132472	214070006	1578	297993
0	86771596	132825	214369602	1518	300089
0	86904332	127566	214671234	1409	303208
0	87031836	129004	214975876	1751	302262
0	87160749	130485	215279914	1561	305917
0	87291136	141231	215587417	1506	305084
0	87432268	135976	215894032	1571	298204
0	87568171	122602	216193832	1245	308603
0	87690689	125231	216503705	1326	307251
0	87815828	127010	216812307	1393	306316
0	87942772	128544	217120041	1411	300631
0	88071226	130793	217422108	1437	300896
0	88201925	132118	217724466	1622	297610
0	88333944	129411	218023723	1426	298150
0	88463259	127655	218323324	1173	292801
0	88590874	127272	218617323	1495	295306
0	88718054	126784	218914149	1666	298328
0	88844739	130345	219214168	1354	296772
0	88974988	126329	219512319	1455	298867
0	89101222	132460	219812666	1623	298032
0	89233593	135092	220112346	1520	303122
0	89368600	128160	220417013	1406	305652
0	89496665	121586	220724096	1762	303608
0	89618154	125792	221029491	1721	298991
0	89743878	123647	221330228	1651	304679
0	89867465	123555	221636583	1796	309982
0	89990986	129449	221948386	1570	300546
0	90120337	130579	222250527	1742	309269
0	90250830	125593	222561563	1615	306960
0	90376328	128175	222870163	1579	305224
0	90504420	122967	223176991	1734	304090
0	90627290	122603	223482840	1672	306855
0	90749795	127480	223791392	1500	299289
0	90877187	126209	224092206	1218	292677
0	91003301	130010	224386126	1608	301297
0	91133297	133729	224689056	1396	306395
0	91266932	133520	224996872	1477	303742
0	91400377	130422	225302116	1568	300599
0	91530703	128100	225604308	1743	317655
0	91658739	130630	225923731	1823	312595
0	91789280	131717	226238174	1810	305835
0	91920902	129262	226545844	1460	307094
0	92050070	128060	226854423	1430	314851
0	92178061	128765	227170729	1474	313492
0	92306733	141772	227485720	1861	323318
0	92448410	138619	227810924	1551	307861
0	92586950	135658	228120361	1747	305784
0	92722511	135423	228427917	1687	304670
0	92857840	133806	228734299	1867	319720
0	92991601	130454	229055911	1861	312417
0	93121955	133546	229370214	1607	309231
0	93255406	130934	229681077	1806	314665
0	93386254	130740	229997573	1528	308852
0	93516929	137926	230307978	1609	305223
0	93654779	137133	230614835	1661	302598
0	93791829	125920	230919119	1812	311055
0	93917666	129966	231232011	1699	305284
0	94047589	119961	231539019	1498	314508
0	94167455	124454	231855050	1658	318495
0	94291809	129898	232175228	1707	312724
0	94421615	115774	232489684	1495	316468
0	94537294	127311	232807672	1625	313985
0	94664530	131628	233123307	1595	303859
0	94796065	123345	233428786	1549	305451
0	94919317	127031	233735811	1775	307842
0	95046253	123028	234045453	1498	310762
0	95169184	127541	234357738	1658	311942
0	95296626	127783	234671363	1535	311271
0	95424323	136940	234984194	1580	310071
0	95561182	135008	235295870	1746	308635
0	95696098	130036	235606276	1708	302950
0	95826058	125573	235910959	1365	299094
0	95951562	132076	236211443	1426	296367
0	96083544	133829	236509261	1378	299018
0	96217276	132454	236809682	1460	297806
0	96349637	141755	237108973	1239	290403
0	96491299	131148	237400640	1764	303398
0	96622361	135989	237705827	1721	300245
0	96758256	136498	238007818	1611	295920
0	96894673	132832	238305374	1665	303213
0	97027407	133293	238610277	1778	305815
0	97160601	144717	238917895	1632	297907
0	97305218	136005	239217459	1632	299084
0	97441135	129789	239518200	1331	295048
0	97570838	134935	239814604	1575	293686
0	97705706	129802	240109890	1648	299551
0	97835417	139717	240411114	1548	294924
0	97975084	136523	240707611	1401	289115
0	98111527	142253	240998152	1415	287656
0	98253683	137332	241287248	1317	290747
0	98390932	141441	241579337	1391	289039
0	98532293	132305	241869792	1521	292238
0	98664513	134225	242163576	1784	295244
0	98798654	133480	242460629	1527	296546
0	98932037	136046	242758727	1659	296825
0	99067984	131554	243057236	1722	297958
0	99199438	130140	243356941	1461	296891
0	99329490	132343	243655318	1517	295687
0	99461738	134173	243952547	1543	296288
0	99595814	131634	244250403	1636	295161
0	99727365	127986	244547225	1582	298467
0	99855254	129198	244847299	1769	304124
0	99984369	125990	245153217	1611	296601
0	100110272	131164	245451454	1380	300775
0	100241340	133374	245753634	1828	309269
0	100374616	140377	246064756	1535	302971
0	100514896	136110	246369287	1538	302656
0	100650911	135770	246673506	1737	307465
0	100786599	134882	246982733	1597	304659
0	100921401	125189	247289014	1534	301618
0	101046526	121003	247592191	1977	311273
0	101167430	125155	247905466	1479	298824
0	101292490	127489	248205794	1555	295956
0	101419881	130178	248503330	1391	295380
0	101549961	129942	248800126	1443	300084
0	101679812	131031	249101678	1542	309457
0	101810746	126256	249412702	1394	300149
0	101936913	129207	249714270	1355	299171
0	102066035	129895	250014821	1625	297388
0	102195831	131062	250313859	1622	291836
0	102326819	134573	250607342	1597	291044
0	102461294	128586	250900008	1567	293480
0	102589805	137870	251195080	1601	290738
0	102727578	137338	251487444	1641	294305
0	102864833	138723	251783415	1700	301151
0	103003473	139961	252086291	1680	296231
0	103143336	137301	252384227	1642	296060
0	103280545	132661	252681954	1754	298090
0	103413118	147223	252981823	1610	290928
0	103560253	146764	253274386	1592	291923
0	103706919	235028	253567926	1759	313539
0	103941874	168401	253883249	1507	303220
0	104110175	115112	254188001	1374	335855
0	104225207	111167	254525255	1117	344797
0	104336287	147663	254871194	1591	292255
0	104483880	147496	255165065	1458	289629
0	104631293	138740	255456177	1547	298572
0	104769939	140569	255756321	1439	295558
0	104910410	139321	256053343	1527	297884
0	105049644	143606	256352779	1660	296408
0	105193202	149263	256650872	1706	299974
0	105342385	147097	256952577	1686	301741
0	105489437	154688	257256029	1409	291450
0	105644045	147692	257548913	1814	300184
0	105791645	149398	257850936	1641	291545
0	105940944	147468	258144147	1462	292689
0	106088324	148836	258438323	1668	292414
0	106237061	139987	258732430	1714	294850
0	106376954	141896	259029019	1570	294342
0	106518758	144919	259324956	1498	291227
0	106663599	140216	259617706	1481	291339
0	106803727	139683	259910551	1469	292446
0	106943334	142567	260204491	1525	291587
0	107085894	132249	260497628	1482	293567
0	107218046	134253	260792702	1075	289594
0	107352209	133403	261083396	1542	294504
0	107485534	137363	261379467	1516	297530
0	107622804	132689	261678538	1545	296269
0	107755409	128525	261976377	1313	295361
0	107883889	131102	262273076	1348	297906
0	108014895	120707	262572355	1811	305244
0	108135514	127940	262879435	1568	294295
0	108263365	128580	263175323	1561	299282
0	108391875	126335	263476191	1516	299180
0	108518113	129779	263776912	1362	303428
0	108647797	132270	264081727	1808	322176
0	108779968	144324	264405736	1508	337442
0	108924195	151226	264744711	1586	339667
0	109075327	123258	265085989	1878	307566
0	109198493	135619	265395458	1713	311987
0	109334051	133972	265709183	1388	308559
0	109467926	144006	266019155	1713	319614
0	109611837	134229	266340507	1663	326528
0	109745985	124688	266668723	1488	330405
0	109870582	129880	267000641	1399	308028
0	110000371	126448	267310093	1415	320157
0	110126734	136459	267631690	1591	327543
0	110263130	122448	267960849	1714	326077
0	110385478	121650	268288665	1711	319680
0	110507038	121917	268610081	1484	316280
0	110628862	115520	268927870	1550	325177
0	110744287	120911	269254622	1469	323318
0	110865100	124923	269579434	1577	316805
0	110989925	113647	269897841	1654	322881
0	111103483	120300	270222401	1278	310399
0	111223692	123724	270534103	1389	305621
0	111347323	125308	270841138	1592	297646
0	111472535	121776	271140401	1586	299580
0	111594214	127606	271441592	1698	300822
0	111721742	119974	271744137	1818	310301
0	111841626	119355	272056281	1844	309018
0	111960889	119045	272367168	1423	310481
0	112079838	130154	272679097	1594	307261
0	112209897	125050	272987977	1556	311842
0	112334952	113997	273301400	1648	319481
0	112448856	113112	273622554	1692	316057
0	112561887	119191	273940328	1363	308499
0	112680989	125504	274250215	1749	314987
0	112806398	122351	274566976	1675	312887
0	112928669	132250	274881563	1524	315039
0	113060825	140392	275198151	1560	306514
0	113201135	132341	275506250	1654	326478
0	113333379	135621	275834407	1766	331281
0	113468928	145239	276167479	1707	324812
0	113614077	133730	276494023	1730	316528
0	113747714	126752	276812306	1392	309193
0	113874368	134525	277122916	1791	303189
0	114008812	135422	277427921	1880	301355
0	114144147	139275	277731181	1646	304046
0	114283341	140698	278036898	1502	303543
0	114423939	126392	278341968	1723	312196
0	114550241	117972	278655912	1465	318075
0	114668117	121347	278975477	1619	319390
0	114789377	122626	279296511	1585	312898
0	114911926	140773	279611019	1555	303121
0	115052608	140318	279915720	1539	311522
0	115192874	137524	280228806	1518	305377
0	115330302	139802	280535726	1659	300021
0	115470005	128492	280837431	1610	299698
0	115598406	122092	281138764	1600	309070
0	115720400	124748	281449459	1290	305631
0	115845064	120336	281756405	1512	307101
0	115965307	119650	282065043	1445	311663
0	116084871	128523	282378176	1712	315335
0	116213297	126208	282695248	1628	313401
0	116339409	128798	283010302	1395	306141
0	116468115	127625	283317863	1624	306003
0	116595664	125294	283625515	1647	312191
0	116720869	123852	283939378	1563	310142
0	116844627	124584	284251108	1327	309388
0	116969116	120149	284561848	1379	310387
0	117089174	120308	284873639	1456	340674
0	117209426	125353	285215794	1602	315302
0	117334722	124854	285532723	1386	316295
0	117459476	119563	285850429	1827	311857
0	117578947	124881	286164138	1402	310082
0	117703756	128768	286475647	1731	314725
0	117832435	131436	286792128	1759	305706
0	117963794	135968	287099618	1420	296140
0	118099663	114837	287397203	1468	318163
0	118214435	124096	287716859	1585	310925
0	118338474	126177	288029394	1429	297171
0	118464566	126905	288328019	1573	298235
0	118591411	131669	288627852	1421	295051
0	118722996	126669	288924349	1856	302565
0	118849592	135020	289228795	1713	298292
0	118984525	124248	289528825	1523	297365
0	119108699	131712	289827738	1693	303986
0	119240313	138149	290133442	1678	299305
0	119378370	122989	290434450	1895	301438
0	119501266	128229	290737808	1623	312755
0	119629432	131738	291052211	1713	310468
0	119761078	132090	291364417	1497	307081
0	119893084	122675	291673020	1581	306060
0	120015668	118786	291980686	1925	317526
0	120134358	126018	292300162	1626	314099
0	120260279	124386	292615912	1555	313769
0	120384610	127166	292931261	1427	303437
0	120511679	68942	293236150	1615	337718
0	120580530	65358	293575508	1852	346611
0	120645805	157374	293923996	1581	355543
0	120803081	292156	294281145	1611	394116
0	121095139	107975	294676897	1643	343884
0	121203059	129501	295022449	1979	309930
0	121332496	48478	295334383	1571	359860
0	121380876	55796	295695839	1076	349463
0	121436608	46756	296046403	1435	360604
0	121483264	1638	296408467	1183	362135
0	121484802	21054044	296771809	1604	371620
0	142538746	45974	297145059	1726	355533
0	142584621	46308	297502343	1744	349359
0	142630832	40939	297853471	1707	372181
0	142671693	112684	298227384	1536	370775
0	142784290	25164	298599720	1452	360364
0	142809355	45798	298961561	1392	350708
0	142855054	66607	299313686	1787	372863
0	142921567	211477	299688361	1724	349632
0	143132965	72673	300039742	1532	386390
0	143205549	83310	300427689	1843	375582
0	143288782	131097	300805139	1480	372139
0	143419780	86682	301178783	1510	377012
0	143506390	241661	301557330	1974	363276
0	143747952	204606	301922605	1663	384388
0	143952464	69764	302308681	1684	352441
0	144022131	142476	302662831	1921	354170
0	144164507	174117	303018947	1301	340308
0	144338531	201991	303360581	1631	362542
0	144540425	145460	303724779	1895	378497
0	144685798	167626	304105196	1806	358666
0	144853324	66785	304465693	1526	323039
0	144920012	64007	304790283	1631	328681
0	144983958	48404	305120620	1726	334832
0	145032264	33936	305457203	1708	324092
0	145066101	42936	305783028	1422	306767
0	145108937	57942	306091242	1524	331007
0	145166781	52631	306423798	1646	351762
0	145219316	49526	306777231	1596	342487
0	145268743	44047	307121339	1725	352689
0	145312690	41341	307475778	1398	323765
0	145353931	96398	307800966	1643	342355
0	145450246	131218	308144989	1598	325990
0	145581365	134680	308472602	1692	325284
0	145715948	192063	308799603	1665	355878
0	145907955	149751	309157171	1661	379030
0	146057618	288397	309537887	1660	381873
0	146345924	172899	309921445	1826	364414
0	146518723	129986	310287710	1564	313660
0	146648618	130814	310602959	1785	311841
0	146779336	125946	310916610	1892	313095
0	146905186	124141	311231622	1766	306397
0	147029239	126966	311539810	1420	311136
0	147156123	123967	311852391	1363	308625
0	147279990	126498	312162404	1747	314841
0	147406390	172495	312479017	1577	373311
0	147578800	164380	312853930	1601	378021
0	147743106	156244	313233577	1465	340355
0	147899250	111732	313575422	1590	353053
0	148010883	232545	313930090	1575	345794
0	148243334	99818	314277484	1273	339652
0	148343054	244805	314618434	1943	380274
0	148587763	164657	315000676	1514	352438
0	148752321	112950	315354653	1657	360987
0	148865171	44917	315717322	1389	374261
0	148909991	97923	316092997	1426	361551
0	149007815	208526	316455999	1848	332068
0	149216249	89328	316789940	1719	363928
0	149305491	151578	317155612	1770	380166
0	149457042	224984	317537573	1611	365659
0	149681950	93349	317904868	1688	359431
0	149775203	134825	318266012	1499	357798
0	149909940	135166	318625334	1702	313541
`

func TestSizes(t *testing.T) {
	s := strings.NewReader(idx)

	cr, err := crai.ReadIndex(s)
	if err != nil {
		t.Fatal(err)
	}
	for i, c := range cr.Sizes()[0] {
		fmt.Printf("1\t%d\t%d\t%d\n", i*16384, (i+1)*16384, c)
	}
}
